<!DOCTYPE html>
<html>

    <head>
        <title>Higher or Lower</title>
        <link rel="stylesheet" type="text/css" href="base.css">
        <script src="script.js"></script>
    </head>

    <style>
        @keyframes shake_rapidly {
            0% {
                transform: translate(1px, 1px) rotate(0deg);
            }
            10% {
                transform: translate(-1px, -2px) rotate(-1deg);
            }
            20% {
                transform: translate(-3px, 0px) rotate(1deg);
            }
            30% {
                transform: translate(3px, 2px) rotate(0deg);
            }
            40% {
                transform: translate(1px, -1px) rotate(1deg);
            }
            50% {
                transform: translate(-1px, 2px) rotate(-1deg);
            }
            60% {
                transform: translate(-3px, 1px) rotate(0deg);
            }
            70% {
                transform: translate(3px, 1px) rotate(-1deg);
            }
            80% {
                transform: translate(-1px, -1px) rotate(1deg);
            }
            90% {
                transform: translate(1px, 2px) rotate(0deg);
            }
            100% {
                transform: translate(1px, -2px) rotate(-1deg);
            }
        }

        @keyframes flip {
            0% {
                font-size: 0px;
                transform: rotateX(0deg);
                transform: rotateY(0deg);
            }
            50% {
                font-size: 2em;
                transform: rotateX(180deg);
                transform: rotateY(180deg);
            }
            100% {
                /* font-size: 0px; */
                transform: rotateX(360deg);
                transform: rotateY(360deg);
            }
        }

        @keyframes score_up {
            50% {
                color: #00ff00;
                text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00, 0 0 30px #00ff00, 0 0 40px #00ff00, 0 0 50px #00ff00, 0 0 60px #00ff00, 0 0 70px #00ff00;
            }
            100% {

            }
        }

        @keyframes tie_score {
            50% {
                color: #a2a2a2;
                text-shadow: 0 0 10px #a2a2a2, 0 0 20px #a2a2a2, 0 0 30px #a2a2a2, 0 0 40px #a2a2a2, 0 0 50px #a2a2a2, 0 0 60px #a2a2a2, 0 0 70px #a2a2a2;
            }
            100% {

            }
        }

        @keyframes score_down {
            50% {
                color: #ff0000;
                text-shadow: 0 0 10px #ff0000, 0 0 20px #ff0000, 0 0 30px #ff0000, 0 0 40px #ff0000, 0 0 50px #ff0000, 0 0 60px #ff0000, 0 0 70px #ff0000;
            }
            100% {

            }
        }
    </style>

    <script>
        var playercard_values = [];
        var opponentcard_values = [];
        var isturn = false;
        var deck = [];

        function onload() {
            // Change the level div to the level
            var level = localStorage.getItem("level");
            document.getElementById("curlvl").innerHTML = "Level " + level;
            // Fill the deck with random cards from 1-10 with a total of 100 cards
            for (var i = 0; i < 100; i++) {
                deck.push(Math.floor(Math.random() * 10) + 1);
            }
            // console.log(deck);
            // console.log("IS it the turn: " + isturn);
            // First, grab the LEVEL ID
            var level = localStorage.getItem("level");
            // Now set localstorages such as "currentround", "roundtype" to default values
            // 50% probability of roundtype => "Higher" and 50% probability of roundtype => "Lower"
            var roundtype = Math.floor(Math.random() * 2) == 0 ? "Higher" : "Lower";
            localStorage.setItem("currentround", 1);
            localStorage.setItem("roundtype", roundtype);
            // Set the player and opponent scores to 0 (pscore, oscore)
            localStorage.setItem("pscore", 0);
            localStorage.setItem("oscore", 0);
            // Grab the current equipped cardstyle
            var style = localStorage.getItem("style");
            // Now, set the cardstyle to the player's equipped cardstyle (i.e. the background of div class playercard)
            var playercards = document.getElementsByClassName("playercard");
            for (var i = 0; i < playercards.length; i++) {
                playercards[i].style.backgroundImage = "url('./src/img/" + style + ".png')";
                playercards[i].style.backgroundSize = "cover";
                playercards[i].style.backgroundPosition = "center";
                playercards[i].style.backgroundRepeat = "no-repeat";
            }
            // Now, depending on the level, set the opponent's cardstyle
            if (level == 1) {
                // indiancard.png for opponent's cardstyle
                var opponentcards = document.getElementsByClassName("opponentcard");
                for (var i = 0; i < opponentcards.length; i++) {
                    opponentcards[i].style.backgroundImage = "url('./src/img/indiancard.png')";
                    opponentcards[i].style.backgroundSize = "cover";
                    opponentcards[i].style.backgroundPosition = "center";
                    opponentcards[i].style.backgroundRepeat = "no-repeat";
                }
            } else if (level == 2) {
                // azteccard.png for opponent's cardstyle
                var opponentcards = document.getElementsByClassName("opponentcard");
                for (var i = 0; i < opponentcards.length; i++) {
                    opponentcards[i].style.backgroundImage = "url('./src/img/azteccard.png')";
                    opponentcards[i].style.backgroundSize = "cover";
                    opponentcards[i].style.backgroundPosition = "center";
                    opponentcards[i].style.backgroundRepeat = "no-repeat";
                }
            } else if (level == 3) {
                // japanesecard.png for opponent's cardstyle
                var opponentcards = document.getElementsByClassName("opponentcard");
                for (var i = 0; i < opponentcards.length; i++) {
                    opponentcards[i].style.backgroundImage = "url('./src/img/japanesecard.png')";
                    opponentcards[i].style.backgroundSize = "cover";
                    opponentcards[i].style.backgroundPosition = "center";
                    opponentcards[i].style.backgroundRepeat = "no-repeat";
                }
            } else if (level == 4) {
                // medievalcard.png for opponent's cardstyle
                var opponentcards = document.getElementsByClassName("opponentcard");
                for (var i = 0; i < opponentcards.length; i++) {
                    opponentcards[i].style.backgroundImage = "url('./src/img/medievalcard.png')";
                    opponentcards[i].style.backgroundSize = "cover";
                    opponentcards[i].style.backgroundPosition = "center";
                    opponentcards[i].style.backgroundRepeat = "no-repeat";
                }
            } else if (level == 5) {
                // goldenhoneycomb.png for opponent's cardstyle
                var opponentcards = document.getElementsByClassName("opponentcard");
                for (var i = 0; i < opponentcards.length; i++) {
                    opponentcards[i].style.backgroundImage = "url('./src/img/goldenhoneycomb.png')";
                    opponentcards[i].style.backgroundSize = "cover";
                    opponentcards[i].style.backgroundPosition = "center";
                    opponentcards[i].style.backgroundRepeat = "no-repeat";
                }
            }

            // Now, generate a set of random values for the player's cards
            // The cards range from 1-10, inclusive. The values are stored in an array
            
            for (var i = 0; i < 3; i++) {
                playercard_values.push(Math.floor(Math.random() * 10) + 1);
            }
            // In the playercolumn, set the values of the playercards by adding three divs with class cardvalue
            // The values of the cards are stored in the array playercard_values
            var playercards = document.getElementsByClassName("playercard");
            for (var i = 0; i < playercards.length; i++) {
                playercards[i].innerHTML = "<div onclick=play_card() id='card" + (i + 1) + "' class='cardvalue' val='" + playercard_values[i] + "'>" + playercard_values[i] + "</div>";
            }
            // Now, generate a random value for the opponent's cards
            // The cards range from 1-10, inclusive. The values are stored in an array
            for (var i = 0; i < 3; i++) {
                opponentcard_values.push(Math.floor(Math.random() * 10) + 1);
            }
            // In the opponentcolumn, set the values of the opponentcards by adding three divs with class cardvalue
            // The values of the cards are stored in the array opponentcard_values
            var opponentcards = document.getElementsByClassName("opponentcard");
            for (var i = 0; i < opponentcards.length; i++) {
                opponentcards[i].innerHTML = "<div onclick=play_card() id='card" + (i + 1) + "' class='cardvalue' val='" + opponentcard_values[i] + "'>" + "?" + "</div>";
            }

            // DEBUG -?>>>>>>>>
            // Console.log() the current values of the player and opponent cards
            // I.e. in teh format of "Player card 1: 2\nPlayer card 2: 10\nPlayer card 3: 7\nOpponent card 1: 5\nOpponent card 2: 8\nOpponent card 3: 9"
            // for (var i = 0; i < 3; i++) {
            //     console.log("Player card " + (i + 1) + ": " + playercard_values[i]);
            //     console.log("Opponent card " + (i + 1) + ": " + opponentcard_values[i]);
            // }

            // Now, set the current round to either higher or lower based on roundtype LCL var
            if (roundtype == "Higher") {
                document.getElementsByClassName("currentround")[0].innerHTML = "Current Round: Higher";
            } else if (roundtype == "Lower") {
                document.getElementsByClassName("currentround")[0].innerHTML = "Current Round: Lower";
            }

            // Apply the flip animation to all cards, the game is ready to start.
            var opponentcards = document.getElementsByClassName("opponentcard");
            var playercards = document.getElementsByClassName("playercard");
            for (var i = 0; i < opponentcards.length; i++) {
                opponentcards[i].style.animation = "flip 3s 1";
            }
            for (var i = 0; i < playercards.length; i++) {
                playercards[i].style.animation = "flip 3s 1";
            }
            setTimeout(function() {
                for (var i = 0; i < opponentcards.length; i++) {
                    opponentcards[i].style.animation = "none";
                }
                for (var i = 0; i < playercards.length; i++) {
                    playercards[i].style.animation = "none";
                }
                isturn = true;
                // console.log("Is it turn? " + isturn);
            }, 3000);
        }

        function play_card() {
            // alert("hi");
            let easy_mode = false;
            let medium_mode = false;
            let hard_mode = false; 

            if (!isturn) return; // if it is not turn yet, return
            // now, set the turn to false
            isturn = false; // so the player has to wait for the opponent to play
            var card = event.target;
            var cardval = card.getAttribute("val");

            // Now, check what the type of round is
            // Grab from lclstorage var
            var roundtype = localStorage.getItem("roundtype");

            // Gather the card that the opponent will play
            // The AI for the first 2 levels will simply play the card with the highest value in a higher round and the lowest value in a lower round
            // In the next few levels, the AI will be able to cheat and read the player's current card values, and play accordingly
            var level = localStorage.getItem("level");
            level = parseInt(level);
            // set levels 1-2 to easy mode, 3-4 medium, 5 hard
            // for now, everything is easy_mode
            if (level == 1 || level == 2) {
                easy_mode = true;
                // console.log("DEBUG: Easy mode")
            } else if (level == 3 || level == 4) {
                easy_mode = true;
                // medium_mode = true;
                // console.log("DEBUG: Medium mode")
            } else if (level == 5) {
                // hard_mode = true;
                easy_mode = true;
                // console.log("DEBUG: Hard mode")
            }

            // Now, let's just simply work on the easy AI
            if (easy_mode) {
                // console.log("Asserting for EASY AI: ---->");
                // console.log("The AI's deck is: " + opponentcard_values);
                // Grab the opponentcard_values array, check for max value if higher round and lowest value if lower round
                // Since it is a global variable, we can access it from anywhere
                var opponent_array = opponentcard_values;
                var opponent_card = 0;
                // Grab the index of the card that the opponent will play alongside its value
                var opponent_card_index = 0;
                var opponent_card_value = 0;
                if (roundtype == "Higher") {
                    // Grab the max value in the array
                    opponent_card_value = Math.max.apply(null, opponent_array);
                    // Grab the index of the max value
                    opponent_card_index = opponent_array.indexOf(opponent_card_value);
                    // Grab the card that the opponent will play
                    opponent_card = document.getElementsByClassName("opponentcard")[opponent_card_index];
                } else if (roundtype == "Lower") {
                    // Grab the min value in the array
                    opponent_card_value = Math.min.apply(null, opponent_array);
                    // Grab the index of the min value
                    opponent_card_index = opponent_array.indexOf(opponent_card_value);
                    // Grab the card that the opponent will play
                    opponent_card = document.getElementsByClassName("opponentcard")[opponent_card_index];
                }

                console.log("The player played: " + cardval + " and the opponent played: " + opponent_card_value + " in a " + roundtype + " round.")
                console.log("The opponents current deck is " + opponent_array + " and the index of the card that the opponent will play is " + opponent_card_index + ".")

                if (roundtype == "Higher") {
                    var winround = false; // player wins round
                    var tie = false;
                    if (cardval > opponent_card_value) {
                        winround = true;
                    } else if (cardval == opponent_card_value) {
                        winround = false;
                        tie = true;
                    } else {
                        winround = false;
                    }

                    // First, apply the animation flip to the opponent card that was chosen
                    opponent_card.style.animation = "none";
                    opponent_card.style.animation = "flip 2s 1";
                    // Now, change the opponent's card innerHTML to the value of the card
                    opponent_card.innerHTML = opponent_card_value;
                    // Set a timeout to wait for the animation to finish
                    setTimeout(function() {
                        if (winround) {
                            // alert("block1");
                            // alert("You won the round!");
                            // grab lclstrg pscore and oscore
                            var pscore = localStorage.getItem("pscore");
                            var oscore = localStorage.getItem("oscore");
                            // increment pscore by 1
                            pscore = parseInt(pscore);
                            pscore += 1;
                            // set lclstrg pscore to pscore
                            localStorage.setItem("pscore", pscore);
                            // change the roundtype with a 50% chance of either higher or lower
                            var roundtype = Math.floor(Math.random() * 2) == 0 ? "Higher" : "Lower";
                            // set lclstrg roundtype to roundtype
                            localStorage.setItem("roundtype", roundtype);

                            // now, grab the score and apply 
                            document.getElementsByClassName("score")[0].innerHTML = "Score: " + pscore + " - " + oscore;
                            // add the score_up 1s 1 animation to the score
                            document.getElementsByClassName("score")[0].style.animation = "score_up 1s 1";
                            // set the roundtype
                            document.getElementsByClassName("currentround")[0].innerHTML = "Current Round: " + roundtype;
                            // settimeout to wait for animation to finish
                            setTimeout(function() {
                                // remove the animation
                                document.getElementsByClassName("score")[0].style.animation = "none";
                                
                                // now, let the player be able to play
                                isturn = true;
                                // if the player has won 3 rounds, the game is over. apply shake_rapidly 2s 1 animation to the table
                                // level++, set lclstrg level to level, set lclstrg pscore and oscore to 0, set lclstrg roundtype to NULL
                                // settimeout to wait for animation to finish, but add 500ms more and go to unlock.html
                                var tablediv = document.getElementsByClassName("table")[0];
                                if (pscore == 3) {
                                    // first ach: imawinner
                                    if (level == 5) {
                                        if (localStorage.getItem("name") == "Crazy Dave") {
                                            alert("Achievement Unlocked: Friend of the Trees");
                                            localStorage.setItem("treefriend", "true");
                                        } else {
                                            // do nothing
                                        }
                                        if (localStorage.getItem("imawinner") == "true") {
                                            // do nothing
                                        } else {
                                            localStorage.setItem("imawinner", "true");
                                            alert("Achievement Unlocked: I'm a Winner")
                                        }
                                    }
                                    /*now achievements*/
                                    /*first ach: 3-0 : thedominator*/
                                    if (oscore==0 && pscore==3) {
                                        if (localStorage.getItem("thedominator")=="true") {
                                            // do nothing
                                        } else {
                                            localStorage.setItem("thedominator", "true");
                                            alert("Achievement Unlocked: The Dominator")
                                            // if last level : then ultchallenge = true
                                            if (level==5) {
                                                if (localStorage.getItem("ultchallenge")=="true"){
                                                    // do nothing
                                                } else {
                                                    localStorage.setItem("ultchallenge", "true");
                                                    alert("Achievement Unlocked: Ultimate Challenge")
                                                }
                                            }
                                        }
                                    } else if (oscore==2 && pscore==3) {
                                        // achievement: down to the wire
                                        if (localStorage.getItem("downtothewire")=="true") {
                                            // do nothing
                                        } else {
                                            localStorage.setItem("downtothewire", "true");
                                            alert("Achievement Unlocked: Down to the Wire")
                                        }
                                    }
                                    tablediv.style.animation = "shake_rapidly 2s 1";
                                    setTimeout(function() {
                                        // increment level
                                        level += 1;
                                        // set lclstrg level to level
                                        localStorage.setItem("level", level);
                                        // set lclstrg pscore and oscore to 0
                                        localStorage.setItem("pscore", 0);
                                        localStorage.setItem("oscore", 0);
                                        // set lclstrg roundtype to NULL
                                        localStorage.setItem("roundtype", "NULL");
                                        // go to unlock.html
                                        window.location.href = "unlock.html";
                                    }, 2500);
                                } else {
                                    var player_array = playercard_values;
                                    var player_card = card;
                                    var player_card_index = player_array.indexOf(parseInt(player_card.getAttribute("val")));
                                    var new_card = deck.pop();
                                    player_card.setAttribute("val", new_card);
                                    player_card.innerHTML = new_card;

                                    // Same for the opponent
                                    var opponent_card = document.getElementsByClassName("opponentcard")[opponent_card_index];
                                    var new_card = deck.pop();
                                    opponent_card.setAttribute("val", new_card);
                                    opponent_card.innerHTML = "?";
                                    opponentcard_values[opponent_card_index] = new_card;
                                }

                            }, 2000);

                        } else if (tie && !winround) {
                            // alert("block2");
                            // alert("You tied!");
                            // change roundtype with a 50% chance of either higher or lower
                            var roundtype = Math.floor(Math.random() * 2) == 0 ? "Higher" : "Lower";
                            // set lclstrg roundtype to roundtype
                            localStorage.setItem("roundtype", roundtype);
                            // apply the tie_score animation to score[0]
                            document.getElementsByClassName("score")[0].style.animation = "tie_score 1s 1";
                            // settimeout to wait for animation to finish
                            // set the roundtype
                            document.getElementsByClassName("currentround")[0].innerHTML = "Current Round: " + roundtype;
                            setTimeout(function() {
                                // remove the animation
                                document.getElementsByClassName("score")[0].style.animation = "none";
                                
                                // now, let the player be able to play
                                isturn = true;
                                var player_array = playercard_values;
                                var player_card = card;
                                var player_card_index = player_array.indexOf(parseInt(player_card.getAttribute("val")));
                                var new_card = deck.pop();
                                player_card.setAttribute("val", new_card);
                                player_card.innerHTML = new_card;

                                // Same for the opponent
                                var opponent_card = document.getElementsByClassName("opponentcard")[opponent_card_index];
                                var new_card = deck.pop();
                                opponent_card.setAttribute("val", new_card);
                                opponent_card.innerHTML = "?";
                                // change the array of opponent card values
                                opponentcard_values[opponent_card_index] = new_card;
                                
                            }, 2000);
                        }

                        else {
                            // alert("block3");
                            // alert("You lost the round!");
                            // oscore ++ 
                            var pscore = localStorage.getItem("pscore");
                            var oscore = localStorage.getItem("oscore");
                            // increment oscore by 1
                            oscore = parseInt(oscore);
                            oscore += 1;
                            // set lclstrg oscore to oscore
                            localStorage.setItem("oscore", oscore);
                            // change the roundtype with a 50% chance of either higher or lower
                            var roundtype = Math.floor(Math.random() * 2) == 0 ? "Higher" : "Lower";
                            // set lclstrg roundtype to roundtype
                            localStorage.setItem("roundtype", roundtype);
                            // set the roundtype
                            document.getElementsByClassName("currentround")[0].innerHTML = "Current Round: " + roundtype;
                            // apply score_down 1s 1 animation to score[0]
                            document.getElementsByClassName("score")[0].style.animation = "score_down 1s 1";
                            document.getElementsByClassName("score")[0].innerHTML = "Score: " + pscore + " - " + oscore;
                            // settimeout to wait for animation to finish
                            setTimeout(function() {
                                //  remove animation
                                document.getElementsByClassName("score")[0].style.animation = "none";
                                
                                // now, let the player be able to play
                                isturn = true;
                                // if the player has lost 3 rounds, the game is over. apply shake_rapidly 2s 1 animation to the table
                                if (oscore == 3) {
                                    // apply shake_rapidly 2s 1 animation to the table
                                    document.getElementsByClassName("table")[0].style.animation = "shake_rapidly 2s 1";
                                    // settimeout to wait for animation to finish, but add 500ms more and go to unlock.html
                                    setTimeout(function() {
                                        // set lclstrg pscore and oscore to 0
                                        localStorage.setItem("pscore", 0);
                                        localStorage.setItem("oscore", 0);
                                        // set lclstrg roundtype to NULL
                                        localStorage.setItem("roundtype", "NULL");
                                        // go to unlock.html
                                        alert("You lost! However you can continue playing! Please press the continue button on the main menu.");
                                        window.location.href = "index.html";
                                    }, 2500);
                                } else {
                                    var player_array = playercard_values;
                                    var player_card = card;
                                    var player_card_index = player_array.indexOf(parseInt(player_card.getAttribute("val")));
                                    var new_card = deck.pop();
                                    player_card.setAttribute("val", new_card);
                                    player_card.innerHTML = new_card;

                                    // Same for the opponent
                                    var opponent_card = document.getElementsByClassName("opponentcard")[opponent_card_index];
                                    var new_card = deck.pop();
                                    opponent_card.setAttribute("val", new_card);
                                    opponent_card.innerHTML = "?";
                                    // change the array of opponent card values
                                    opponentcard_values[opponent_card_index] = new_card;
                                }
                            }, 2000);
                        }
                    })
                } else if (roundtype == "Lower") {
                    var winround = false;
                    var tie = false;
                    // if the card value is lower than opponent's card value, winround = true
                    if (cardval < opponent_card_value) {
                        winround = true;
                    } else if (cardval == opponent_card_value) {
                        tie = true;
                    } else {
                        winround = false;
                    }

                    // First, apply the animation flip to the opponent card that was chosen
                    opponent_card.style.animation = "none";
                    opponent_card.style.animation = "flip 2s 1";
                    // Now, change the opponent's card innerHTML to the value of the card
                    opponent_card.innerHTML = opponent_card_value;

                    setTimeout(function() {
                        // if winround
                        if (winround) {
                            // alert("block4");
                            // alert("You won the round!");
                            // pscore ++
                            var pscore = localStorage.getItem("pscore");
                            var oscore = localStorage.getItem("oscore");
                            // increment pscore by 1
                            pscore = parseInt(pscore);
                            pscore += 1;
                            // set lclstrg pscore to pscore
                            localStorage.setItem("pscore", pscore);
                            // apply score_up 1s 1 animation to score[0]
                            document.getElementsByClassName("score")[0].style.animation = "score_up 1s 1";
                            document.getElementsByClassName("score")[0].innerHTML = "Score: " + pscore + " - " + oscore;
                            var roundtype = Math.floor(Math.random() * 2) == 0 ? "Higher" : "Lower";
                            // set the roundtype
                            document.getElementsByClassName("currentround")[0].innerHTML = "Current Round: " + roundtype;
                            // settimeout to wait for animation to finish
                            setTimeout(function() {
                                // remove animation
                                document.getElementsByClassName("score")[0].style.animation = "none";
                                // now, let the player be able to play
                                isturn = true;
                                // if the player has won 3 rounds, the game is over. apply shake_rapidly 2s 1 animation to the table
                                if (pscore == 3) {
                                    // apply shake_rapidly 2s 1 animation to the table
                                    document.getElementsByClassName("table")[0].style.animation = "shake_rapidly 2s 1";
                                    // settimeout to wait for animation to finish, but add 500ms more and go to unlock.html
                                    setTimeout(function() {
                                        // increment level
                                        level += 1;
                                        // set lclstrg level to level
                                        localStorage.setItem("level", level);
                                        // set lclstrg pscore and oscore to 0
                                        localStorage.setItem("pscore", 0);
                                        localStorage.setItem("oscore", 0);
                                        // set lclstrg roundtype to NULL
                                        localStorage.setItem("roundtype", "NULL");
                                        // go to unlock.html
                                        window.location.href = "unlock.html";
                                    }, 2500);
                                } else {
                                    var player_array = playercard_values;
                                    var player_card = card;
                                    var player_card_index = player_array.indexOf(parseInt(player_card.getAttribute("val")));
                                    var new_card = deck.pop();
                                    player_card.setAttribute("val", new_card);
                                    player_card.innerHTML = new_card;

                                   // Same for the opponent
                                    var opponent_card = document.getElementsByClassName("opponentcard")[opponent_card_index];
                                    var new_card = deck.pop();
                                    opponent_card.setAttribute("val", new_card);
                                    opponent_card.innerHTML = "?";
                                    // change the array of opponent card values
                                    opponentcard_values[opponent_card_index] = new_card;
                                }

                            }, 2000);

                        } else if (tie && !winround) {
                            // alert("block5");
                            // alert("You tied the round!");
                            // change roundtype with a 50% chance of either higher or lower
                            var roundtype = Math.floor(Math.random() * 2) == 0 ? "Higher" : "Lower";
                            // set lclstrg roundtype to roundtype
                            localStorage.setItem("roundtype", roundtype);
                            // apply tiescore 1s 1 animation to score[0]
                            document.getElementsByClassName("score")[0].style.animation = "tie_score 1s 1"; 
                            // settimeout to wait for animation to finish
                            // set the roundtype
                            document.getElementsByClassName("currentround")[0].innerHTML = "Current Round: " + roundtype;
                            
                            setTimeout(function() {
                                // remove animation
                                document.getElementsByClassName("score")[0].style.animation = "none";
                                // now, let the player be able to play
                                isturn = true;
                                var player_array = playercard_values;
                                var player_card = card;
                                var player_card_index = player_array.indexOf(parseInt(player_card.getAttribute("val")));
                                var new_card = deck.pop();
                                player_card.setAttribute("val", new_card);
                                player_card.innerHTML = new_card;

                                // Same for the opponent
                                var opponent_card = document.getElementsByClassName("opponentcard")[opponent_card_index];
                                var new_card = deck.pop();
                                opponent_card.setAttribute("val", new_card);
                                opponent_card.innerHTML = "?";
                                // change the array of opponent card values
                                opponentcard_values[opponent_card_index] = new_card;

                            }, 2000);

                        } else {
                            // alert("block6");
                            // alert("You lost the round!");
                            // oscore ++
                            var pscore = localStorage.getItem("pscore");
                            var oscore = localStorage.getItem("oscore");
                            // increment oscore by 1
                            oscore = parseInt(oscore);
                            oscore += 1;
                            // set lclstrg oscore to oscore
                            localStorage.setItem("oscore", oscore);
                            // apply score_down 1s 1 animation to score[0]
                            document.getElementsByClassName("score")[0].style.animation = "score_down 1s 1";
                            // change the score
                            document.getElementsByClassName("score")[0].innerHTML = "Score: " + pscore + " - " + oscore;
                            // settimeout to wait for animation to finish
                            var roundtype = Math.floor(Math.random() * 2) == 0 ? "Higher" : "Lower";
                            // set the roundtype
                            document.getElementsByClassName("currentround")[0].innerHTML = "Current Round: " + roundtype;
                            setTimeout(function() {
                                // remove animation
                                document.getElementsByClassName("score")[0].style.animation = "none";
                                // now, let the player be able to play
                                isturn = true;
                                // if the player has lost 3 rounds, the game is over. apply shake_rapidly 2s 1 animation to the table
                                if (oscore == 3) {
                                    // apply shake_rapidly 2s 1 animation to the table
                                    document.getElementsByClassName("table")[0].style.animation = "shake_rapidly 2s 1";
                                    // settimeout to wait for animation to finish, but add 500ms more and go to unlock.html
                                    setTimeout(function() {
                                        // set lclstrg pscore and oscore to 0
                                        localStorage.setItem("pscore", 0);
                                        localStorage.setItem("oscore", 0);
                                        // set lclstrg roundtype to NULL
                                        localStorage.setItem("roundtype", "NULL");
                                        // go to unlock.html
                                        alert("You lost! However you can continue playing! Please press the continue button on the main menu.");
                                        window.location.href = "index.html";
                                    }, 2500);
                                } else {
                                    var player_array = playercard_values;
                                    var player_card = card;
                                    var player_card_index = player_array.indexOf(parseInt(player_card.getAttribute("val")));
                                    var new_card = deck.pop();
                                    player_card.setAttribute("val", new_card);
                                    player_card.innerHTML = new_card;

                                    // Same for the opponent
                                    var opponent_card = document.getElementsByClassName("opponentcard")[opponent_card_index];
                                    var new_card = deck.pop();
                                    opponent_card.setAttribute("val", new_card);
                                    opponent_card.innerHTML = "?";
                                    // change the array of opponent card values
                                    opponentcard_values[opponent_card_index] = new_card;
                                }
                            }, 2000);
                        }
                    })
                }

                
                
            }
                document.getElementsByClassName("currentround")[0].innerHTML = "Current Round: " + roundtype;
        }

    </script>

    <body onload="onload()">
        <div class="title2" id="curlvl">Level NULL</div>
        <!-- This is the pool table where all the game actions will occur -->
        <div class="currentround">Current Round: NULL</div>
        <div class="score">Score: 0 - 0</div>
        <div class="table">
            <div class="playercolumn">
                YOU
                <div class="playercard">
                    <div onclick=play_card() id="card1" class="cardvalue" val="2">2</div>
                </div>
                <div class="playercard">
                    <div onclick=play_card() id="card2" class="cardvalue" val="10">10</div>
                </div>
                <div class="playercard">
                    <div onclick=play_card() id="card3" class="cardvalue" val="7">7</div>
                </div>
            </div>

            <div class="opponentcolumn">
                THEM
                <div class="opponentcard">
                    <div class="cardvalue" val="1">?</div>
                </div>
                <div class="opponentcard">
                    <div class="cardvalue" val="1">?</div>
                </div>
                <div class="opponentcard">
                    <div class="cardvalue" val="1">?</div>
                </div>
            </div>
        </div>

    </body>

</html>
